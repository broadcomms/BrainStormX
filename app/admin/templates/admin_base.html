<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>{% block title %}Admin Â· BrainStormX{% endblock %}</title>

        <link
            rel="icon"
            href="{{ url_for('static', filename='favicon.png') }}"
            type="image/png"
        />

        <!-- Bootstrap 5.3.1 -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
            rel="stylesheet"
            crossorigin="anonymous"
        />

    <!-- Bootstrap Icons -->
    <!-- Updated Bootstrap Icons (was 1.3.0; newer version required for bi-diagram-3, bi-easel2, bi-files) -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/v4-shims.min.css">

        <!-- Optional fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
            rel="stylesheet"
        />

        <link rel="stylesheet" href="{{ url_for('admin.static', filename='css/admin.css') }}" />

        {% block extra_head %}{% endblock %}
    </head>

    <body class="bg-body-tertiary min-vh-100 d-flex flex-column" data-bs-theme="light">
        <nav class="navbar navbar-expand-lg bg-body border-bottom shadow-sm sticky-top">
            <div class="container-fluid">
                <a class="navbar-brand d-inline-flex align-items-center" href="{{ url_for('admin.dashboard') }}">
                    <i class="fa fa-brain text-primary me-1" aria-hidden="true"></i>
                    <span class="fw-bold text-primary">Brain</span><span>StormX</span>
                </a>
                <button
                    class="navbar-toggler"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#adminNavbar"
                    aria-controls="adminNavbar"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
                >
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-end" id="adminNavbar">
                    <ul class="navbar-nav align-items-lg-center gap-lg-3">
                        <li class="nav-item">
                            <span class="nav-link d-flex flex-column flex-lg-row align-items-lg-center gap-2 mb-2 mb-lg-0">
                                <span class="fw-semibold">{{ current_user.display_name }}</span>
                            </span>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-outline-danger btn-sm" href="{{ url_for('auth_bp.logout') }}">
                                <i class="bi bi-box-arrow-right me-1"></i>Sign out
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <div id="admin-notification-area" class="toast-container position-fixed top-0 end-0 p-3 admin-toast-container"></div>

        <div class="container-fluid flex-grow-1 py-4">
            <div class="row flex-column flex-lg-row g-4">
                <aside class="col-12 col-lg-3 col-xl-2">
                    <div class="card shadow-sm border-0 h-100">
                        <div class="card-header bg-transparent border-bottom py-3">
                            <div class="d-flex flex-column">
                                <strong>Administration</strong>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div class="list-group list-group-flush">
                                {% for item in admin_nav_items %}
                                    <a
                                        href="{{ url_for(item.endpoint) }}"
                                        class="list-group-item list-group-item-action d-flex justify-content-between align-items-center {% if request.endpoint == item.endpoint %}active{% endif %}"
                                        aria-current="{% if request.endpoint == item.endpoint %}true{% else %}false{% endif %}"
                                    >
                                        <span>{{ item.label }}</span>
                                        {% if request.endpoint == item.endpoint %}
                                            <i class="bi bi-chevron-right small"></i>
                                        {% endif %}
                                    </a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </aside>

                <main class="col">
                    <div class="d-flex flex-column gap-3">
                        <header class="bg-body border rounded-3 shadow-sm p-4">
                            <div class="d-flex flex-column flex-lg-row justify-content-between align-items-lg-center gap-3">
                                <div>
                                    <h1 class="h3 mb-1">{% block header_title %}{% endblock %}</h1>
                                    <p class="text-body-secondary mb-0">{% block header_subtitle %}{% endblock %}</p>
                                </div>
                                <div class="text-lg-end">
                                    <span class="badge text-bg-primary text-wrap">Admin access</span>
                                </div>
                            </div>
                        </header>

                        {% with messages = get_flashed_messages(with_categories=True) %}
                            {% if messages %}
                                <div class="alert-stack">
                                    {% for category, message in messages %}
                                        {% set tone = category if category in ['primary','secondary','success','danger','warning','info','light','dark'] else 'info' %}
                                        <div class="alert alert-{{ tone }} alert-dismissible fade show shadow-sm" role="alert">
                                            {{ message | safe }}
                                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                        </div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        {% endwith %}

                        <section class="bg-body rounded-3 shadow-sm p-4">
                            {% block content %}{% endblock %}
                        </section>
                    </div>
                </main>
            </div>
        </div>

        <footer class="bg-body border-top py-3 mt-auto small text-center text-body-secondary">
            &copy; {{ current_year or "2025" }} <span class="fw-semibold">BrainStormX</span>. All rights reserved.
        </footer>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
            crossorigin="anonymous"
        ></script>
        <script src="{{ url_for('admin.static', filename='js/admin.js') }}" defer></script>
        {% block extra_scripts %}{% endblock %}
    </body>
</html>
